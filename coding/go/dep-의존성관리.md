# 개요
Go 에서는 dep 을 공식 의존성 관리 도구로 언급하고 있다.

# dep 설치
homebrew 로 설치 가능
```sh
brew install dep
dep version
```

# dep 으로 의존성 관리하기
go get 으로 설치하면 $GOPATH/src 아래 소스코드가 들어가는데 이 아래 있으면 로컬에서 import 로 불러서 사용할 수 있다.

하지만 소스코드에 Import 구문이 있다고 하더라도 go get 으로 설치하려면 의존성을 일일이 찾아서 설치해야 하므로
협업하기에는 어려움이 있다.

새 프로젝트에서 dep 으로 의존성을 관리하려면 초기화를 해야 한다.
```bash
dep init
```

초기화를 하면 아래처럼 2개의 파일과 1개의 디렉터리가 생성된다.
- Gopkg.lock
- Gopkg.toml
- vendor/

## Gopkg.toml
초기화할 때 생성되는 파일로 dep 의 동작을 감시하는 규칙을 담고 있다.

- 의존성 규칙 : `constraints`, `overrides` 로 사용자가 적용할 의존성의 버전과 어디서 가져와야 하는지 지정
- 패키지 그래프 규칙 : `requried`, `ignored` 로 임포트 경로를 추가하거나 제외해서 임포트 그래프 조작
- metadata : 사용자가 정의한 키값의 맵으로 `dep` 은 무시
- prune : 어떤 파일과 디렉터리가 불필요하다고 판단할지 설정해서 vendor/ 에서 자동으로 제거한다.

```bash
# Gopkg.toml example
#
# Refer to https://github.com/golang/dep/blob/master/docs/Gopkg.toml.md
# for detailed Gopkg.toml documentation.
#
# required = ["github.com/user/thing/cmd/thing"]
# ignored = ["github.com/user/project/pkgX", "bitbucket.org/user/project/pkgA/pkgY"]
#
# [[constraint]]
#   name = "github.com/user/project"
#   version = "1.0.0"
#
# [[constraint]]
#   name = "github.com/user/project2"
#   branch = "dev"
#   source = "github.com/myfork/project2"
#
# [[override]]
#   name = "github.com/x/y"
#   version = "2.4.0"
#
# [prune]
#   non-go = false
#   go-tests = true
#   unused-packages = true


[prune]
  go-tests = true
  unused-packages = true
```

## Gopkg.lock
프로젝트의 의존성 그래프의 스냅숏을 가진 파일이다. 이 파일은 `dep ensure` 할 때 변경된다.
```bash
# This file is autogenerated, do not edit; changes may be undone by the next 'dep ensure'.


[solve-meta]
  analyzer-name = "dep"
  analyzer-version = 1
  inputs-digest = "ab4fef131ee828e96ba67d31a7d690bd5f2f42040c6766b1b12fe856f87e0ff7"
  solver-name = "gps-cdcl"
  solver-version = 1
```

`gin` 을 사용하기 위해 의존성을 추가하려면 다음과 같이 한다.
```bash
dep ensure -add github.com/gin-gonic/gin
```

# dep 관련 파일 버전 관리
dep 이 생성한 파일은 Gopkg.toml, Gopkg.lock 과 vender 디렉터리다.
일반적으로 Gopkg.toml 과 Gopkg.lock 두 파일을 모두 commit 한다고 한다.

vendor 디렉터리의 경우 dep의 FAQ 문서를 보면 커밋해서 관리할 때의 장단점이 나와있다고 한다.
하지만 그냥 git 에서 제외했다고 한다.

# 의존성 설치
프로젝트를 협업하는 경우, Gopkg.toml, Gopkg.lock 을 가진 저장소를 받아서 의존성을 설치해서 개발해야한다.
```bash
dep ensure
```

# 핵심 내용
`dep` 을 사용해서 go package 의 의존성 관리 방법 설명

# ref
[Go 에서 dep 으로 의존선 관리하기](https://blog.outsider.ne.kr/1354)